{# C:\Users\f19705e\PycharmProjects\truck_booking_app\templates\admin_user_edit.html #}

{% extends 'base.html' %}
{% load i18n %}

{# Updated: Use user_to_edit.username for a more descriptive title #}
{% block title %}{% translate "Edit User" %}: {{ user_to_edit.username }}{% endblock %}

{% block content %}
<div class="container"> {# Added container for consistent layout #}
    {# Updated: Use user_to_edit.username for the main heading #}
    <h1>{% translate "Edit User" %}: {{ user_to_edit.username }}</h1>

    <form method="post" class="mt-3"> {# Added mt-3 for top margin #}
        {% csrf_token %}
        {{ form.non_field_errors }}

        {# Display specific fields you want to allow editing #}
        {# Using mb-3 for margin-bottom, form-label for labels, and text-danger for errors #}
        <div class="mb-3">
            <label for="{{ form.username.id_for_label }}" class="form-label">{% translate "Username" %}:</label>
            {{ form.username }}
            {% if form.username.help_text %}<div class="form-text text-muted">{% translate form.username.help_text %}</div>{% endif %}
            {% if form.username.errors %}<div class="text-danger">{% for error in form.username.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label for="{{ form.email.id_for_label }}" class="form-label">{% translate "Email" %}:</label>
            {{ form.email }}
            {% if form.email.help_text %}<div class="form-text text-muted">{% translate form.email.help_text %}</div>{% endif %}
            {% if form.email.errors %}<div class="text-danger">{% for error in form.email.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label for="{{ form.first_name.id_for_label }}" class="form-label">{% translate "First Name" %}:</label>
            {{ form.first_name }}
            {% if form.first_name.help_text %}<div class="form-text text-muted">{% translate form.first_name.help_text %}</div>{% endif %}
            {% if form.first_name.errors %}<div class="text-danger">{% for error in form.first_name.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        <div class="mb-3">
            <label for="{{ form.last_name.id_for_label }}" class="form-label">{% translate "Last Name" %}:</label>
            {{ form.last_name }}
            {% if form.last_name.help_text %}<div class="form-text text-muted">{% translate form.last_name.help_text %}</div>{% endif %}
            {% if form.last_name.errors %}<div class="text-danger">{% for error in form.last_name.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        {# Conditional rendering for phone_number: only display if the field exists in the form #}
        {% if form.phone_number %}
        <div class="mb-3">
            <label for="{{ form.phone_number.id_for_label }}" class="form-label">{% translate "Phone Number" %}:</label>
            {{ form.phone_number }}
            {% if form.phone_number.help_text %}<div class="form-text text-muted">{% translate form.phone_number.help_text %}</div>{% endif %}
            {% if form.phone_number.errors %}<div class="text-danger">{% for error in form.phone_number.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        {% endif %}

        {# Checkboxes for basic user status #}
        <div class="mb-3 form-check" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
            <label class="form-check-label" for="{{ form.is_active.id_for_label }}">{% translate "Is Active" %}</label>
            {{ form.is_active }}
            {% if form.is_active.help_text %}<div class="form-text text-muted">{% translate form.is_active.help_text %}</div>{% endif %}
            {% if form.is_active.errors %}<div class="text-danger">{% for error in form.is_active.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        <div class="mb-3 form-check" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
            <label class="form-check-label" for="{{ form.is_staff.id_for_label }}">{% translate "Is Staff" %}</label>
            {{ form.is_staff }}
            {% if form.is_staff.help_text %}<div class="form-text text-muted">{% translate form.is_staff.help_text %}</div>{% endif %}
            {% if form.is_staff.errors %}<div class="text-danger">{% for error in form.is_staff.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        <div class="mb-3 form-check" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
            <label class="form-check-label" for="{{ form.is_superuser.id_for_label }}">{% translate "Is Superuser" %}</label>
            {{ form.is_superuser }}
            {% if form.is_superuser.help_text %}<div class="form-text text-muted">{% translate form.is_superuser.help_text %}</div>{% endif %}
            {% if form.is_superuser.errors %}<div class="text-danger">{% for error in form.is_superuser.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        {% if form.is_admin_member_checkbox %}
        <div class="mb-3 form-check" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
            <label class="form-check-label" for="{{ form.is_admin_member_checkbox.id_for_label }}">
                {% translate "Grant Custom Admin Dashboard Access (Adds to 'Admin' Group)" %}
            </label>
            {{ form.is_admin_member_checkbox }}
            {% if form.is_admin_member_checkbox.help_text %}<div class="form-text text-muted">{% translate form.is_admin_member_checkbox.help_text %}</div>{% endif %}
            {% if form.is_admin_member_checkbox.errors %}<div class="text-danger">{% for error in form.is_admin_member_checkbox.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        {% endif %}

        {% if form.groups %} {# Only render if the field exists in the form #}
        <div class="mb-3">
            <h2>{% translate "Assign to Other Groups" %}:</h2>
            <div class="checkbox-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px;">
                {{ form.groups }}
            </div>
            {% if form.groups.help_text %}<div class="form-text text-muted">{% translate form.groups.help_text %}</div>{% endif %}
            {% if form.groups.errors %}<div class="text-danger">{% for error in form.groups.errors %}{{ error }}{% endfor %}</div>{% endif %}
        </div>
        {% endif %}

        <div class="mb-3">
            <h2>{% translate "Password Management" %}</h2>
            <p class="text-muted">{% translate "Click the button below to reset this user's password. You will be prompted to enter a new password." %}</p>
            <a href="{% url 'booking_app:admin_user_reset_password' pk=user_to_edit.pk %}" class="btn btn-warning">{% translate "Reset User Password" %}</a>
        </div>
        <br>
        <button type="submit" class="btn btn-primary">{% translate "Update User" %}</button>
    </form>

    <p class="mt-3"><a href="{% url 'booking_app:admin_user_list' %}" class="back-link">{% translate "Back to User List" %}</a></p>
</div> {# Close container div #}
{% endblock content %}